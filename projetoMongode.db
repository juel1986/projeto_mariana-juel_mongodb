//Busque filmes lançados entre 1997 e 2004
db.filmes.find().pretty()
//Busque filmes de 2001 ou que comecem com a letra D.
db.filmes.find(
  { ano:{
      $gte:"1997", $lte:"2010" }
    }).sort({ano:1})
//Busque filmes lançados dirigidos pelo Peter Jackson ou pelo Walter Salles usando $in.
    db.filmes.find(
  { $or: [ {ano:"2001"},
      {nome: /^D/} ] } )
//Busque filmes lançados entre 2002 e 2021 e que contenham as atrizes Naomi Watts ou Carey Mulligan.
db.filmes.find(
  { diretor:{ $in:["Peter Jackson", "Walter Salles"]
      } })
//Busque todos os filmes que não sejam entre 2001 e 2005.
db.filmes.find({
    $and: [ { $or: [{ano:{$gte: "2002"}}, {ano:{$lte: "2021"}}] },
        { $or: [{elenco:{$eq: "Naomi Watts"}}, {elenco:{$eq: "Carey Mulligan"}}]}
         ] })
//Conte quantos filmes foram lançados em 2001.
db.filmes.find({
  ano:{ $not:{ $gte:"2001", 
     $lte:"2005" } } }).sort({ ano: 1 })
//Selecione apenas o elenco numa distinct.
db.filmes.distinct("elenco"),
//Selecione os filmes lançados em 2001, apresentando seu nome e diretor apenas, em ordem decrescente, limitando a dois resultados.
db.filmes.find({},{ano:"2001",diretor:1, nome:1}).limit(2).sort({nome:-1}),
//Crie uma index usando o ano como referência exibindo o index criado
db.filmes.createIndex({ano:2},{name:"Todos os anos dos filmes"}), 
//Some os prêmios de todos os filmes
db.filmes.aggregate([
    { $group: {_id:"",premios:{$sum:"$premios"}
        }}, { $project: {"total de Premios":"$premios"}} ])
//Na coleção `sample_mflix` do Mongo Atlas DB, crie uma consulta que retorne os filmes com os seus comentários utilizando o estágio de agrupamento (e.g.: `$lookup`).
use("sample_mflix")
db.comments.aggregate([
  {$lookup: { from:"movies",
    localField:"movie_id",
    foreignField:"_id",as:"Filmes"} } ])


    